# 变更日志

## [1.8.8] - 2024-11-01

### 重大变更

* 重新提供对 Android 6-8 设备的有限支持
* 适配 E 站缩略图和 WebP 等相关变更

### 改进

* 限制里站缩略图并发数，防止在快速滚动时出现大规模的加载失败
* 解析画廊列表的错误信息
* 修改标签样式（半透明=0-9MP，斜体=10-99MP，普通=100+MP）并支持在投票后自动刷新标签
* 支持一键刷新 cookie，并显示其过期时间
* 显示临时配额的过期时间
* 为下载页面添加更多排序方式，并记住上次选择的排序方式
* 记住上次选择的排行榜
* 为恢复下载项、清理下载冗余功能添加确认框

### Bug 修复

* 修复图片预载顺序错乱的问题
* 修复画廊详情页无法通过点击错误刷新的问题
* 修复我的标签页面无法切换标签集的问题
* 修复强制使用 E-Hentai 缩略图服务器功能，并不再强制使用 E-Hentai API 服务器
* 修复某些情况下 H@H 图片校验错误
* 修复小缩略图的淡入效果 @revonateB0T 

## [1.8.7] - 2024-09-12

### 重大变更

* 适配 E 站新配额系统（不显示 IP 配额、支持临时配额）

### 改进

* 增加图片校验，避免加载被篡改的 H@H 图片
* 游客用户访问设置页时不再尝试获取配额信息
* 支持自定义 User Agent，如有必要请自行更改为桌面端
* 移除内置 hosts
* A13 及以上系统也显示复制通知
* 支持下载单页原图
* 支持清除指定画廊的缓存
* E 站不再强制人机验证，故加回传统登录页面
* 解析 Cookie 封禁错误
* 优化 Cookie 粘贴，无 igneous 也可识别

### Bug 修复

* 修复种子数量解析 @FooIbar
* 修复从画廊预览页进入阅读器时的进度错误
* 修复进入网页设置后所有 Cookie 有效期被转为永久的问题

## [1.8.6] - 2024-05-14

### 重大变更

* 使用更先进的元数据序列化机制以兼容彩 E 的下载数据，此版本及以后的下载数据将无法被旧版本应用读取

### 改进

* 支持升级已下载的画廊 [⚠需要 Hath Perk: Multi-Page Viewer]
* 在登录时初始化搜藏夹名称 [#59](https://github.com/EhViewer-NekoInverter/EhViewer/issues/59)
* 禁止在 cookie 界面截图以防止不经意的信息泄露
* 支持通过 ComicInfo.xml 恢复下载项

### Bug 修复

* 修复图片搜索功能 [由于 E 站限制，现在仅能搜索完全匹配图片]
* 修复图片下载未遵循先进先出原则

## [1.8.5] - 2024-03-23

### 重大变更

* 由于登录强制需要人机验证，移除传统登录页面

### 改进

* 支持阅读时自动翻页

### Bug 修复

* 修复部分情况下缩略图动画闪退

## [1.8.4] - 2024-03-07

### 改进

* 支持直接清除 igneous 而无需重新登录

### Bug 修复

* 修复种子解析失败问题

## [1.8.3] - 2024-03-03

### 改进

* 归档下载支持调用第三方下载器

### Bug 修复

* 修复数据过多时滚动条消失的问题 [#38](https://github.com/EhViewer-NekoInverter/EhViewer/issues/38)

## [1.8.2.1] - 2024-03-03

### 改进

* 支持手动调整下载项顺序
* 支持从本地读取下载项封面图
* 支持在详情页长按收藏按钮更改收藏分类
* 从 H@H 下载原图失败后自动尝试从源服务器下载
* 增加阅读器加载动画

### Bug 修复

* 修复某些情况下无法调整下载标签顺序 [#56](https://github.com/EhViewer-NekoInverter/EhViewer/issues/56)

## [1.8.2] - 2023-11-01

### 改进

* 鉴于中文评论区涌入大量网络低能，贴心地增加了按分数屏蔽评论的功能

### Bug 修复

* 修复原图下载
* 修复 Android 9 打开评论区白屏 [#55](https://github.com/EhViewer-NekoInverter/EhViewer/issues/55)

## [1.8.1] - 2023-10-28

### 重大变更

* 修复从 API 获取图片地址时解析失败的问题
* 本次网站更新后，移动端的自动分辨率变成了 780px，而不是原来的 1280px，如果觉得图片有点糊请自行在网站设置中调整分辨率

### 改进

* 重构下载延迟以缓解 IP 封禁
* 优化图片下载重试策略，减少配额消耗
* 实现下载超时，可在 设置-下载 中调整

### Bug 修复

* 修复状态栏文字/图标颜色错误

## [1.8.0] - 2023-09-09

### 改进

* 移除代理设置、hosts 设置

### Bug 修复

* 修复里站配额获取
* 修复种子列表解析

## [1.7.30] - 2023-08-06

### 重大变更

* 移除域名前置，直连用户请考虑换用其他软件
* 适配网站变更，优化原图下载 (自 2023-07-07 起，发布时间超过一年的画廊下载原图需要消耗 GP)

### 改进

* 支持使用 WebView 进行 Cloudflare 验证，缓解 403 问题

### Bug 修复

* 修复 1.7.29.4 版本跳页闪退
* 修复压缩包下载和配额重置
* 修复下载时缩略图闪烁

## [1.7.29.4] - 2023-05-16

### 重大变更

* 适配 exhentai 缩略图域名变更

### 改进

* 本地标签屏蔽列表支持显示翻译

## [1.7.29.3] - 2023-04-04

### 改进

* 优化允许媒体扫描
* 优化标签翻译数据库加载与更新逻辑
* 优化标签建议，不再限制建议数量

### Bug 修复

* 修复重新下载时无法获取原文件 [#35](https://github.com/EhViewer-NekoInverter/EhViewer/issues/35)
* 修复移动本地收藏至云端后未删除本地收藏
* 修复某些情况下缩略图闪烁

## [1.7.29.2] - 2023-03-25

### 改进

* 优化侧边栏夜间模式切换逻辑，优先设为跟随系统
* 使用 room 重构 cookie 数据库

### Bug 修复

* 修复空压缩包不显示错误信息
* 修复从上至下阅读模式下的翻页回弹问题 [seven332/EhViewer#653](https://github.com/seven332/EhViewer/issues/653)
* 修复已下载画廊的图片无法长按保存

## [1.7.29.1] - 2023-03-22

### 重大变更

* 将缩略图和缓存组件更换为 Coil 实现，所有缓存图片需要重新加载

### 改进

* 将 “退出登录” 与 “身份 Cookie” 合并为 “账户”
* 协程化 Spider Queen
* 优化压缩包读取

### Bug 修复

* 修复未退出阅读器时无法打开压缩包
* 修复快速搜索项目过多时切换页面崩溃 [#33](https://github.com/EhViewer-NekoInverter/EhViewer/issues/33)
* 修复已下载画廊的图片无法长按保存

## [1.7.29] - 2023-03-12

### 重大变更

* 移除数据库版本验证，兼容的数据都可以直接导入
* 支持查看与重置图片配额，支持在压缩包下载页面显示账户余额
* 重构登录逻辑，防止 IP 污染，捐赠用户不会再遇到白屏 [Ehviewer-Overhauled/Ehviewer#873](https://github.com/Ehviewer-Overhauled/EhViewer/issues/873)

### 改进

* 支持设置缩略图缓存大小
* 支持在启用域名前置时绕过 VPN
* 支持在压缩包下载页面显示账户余额
* 评论编辑器增强
* 重构标签数据库，优化标签建议顺序：完全匹配->起始匹配->包含匹配
* 重构 EhEngine
* 移除新用户导引

### Bug 修复

* 修复快速切换页面导致的崩溃
* 修复历史记录中的收藏状态显示，仅更新后的记录有效
* 修复 509 误报
* 修复无主画廊上传者评论显示、评论上次修改时间显示
* 修复评论删除线显示

## [1.7.28.7] - 2023-02-16

### 改进

* 使用半透明表示弱权重标签，使用黄色/灰色表示已赞/已踩标签

### Bug 修复

* 修复阅读器页码出现黑色背景
* 修复 GIF 渲染时未清除上一帧内容

## [1.7.28.6] - 2023-02-05

### 改进

* 归档文件名称排序不再忽略前置零
* 添加了表站 Sad Panda 与 503 错误提示

### Bug 修复

* 修复上一版本变更导致的缩略图重载
* 修复某些非中文情况下标签翻译默认打开
* 修复余额不足时不显示归档文件下载

## [1.7.28.5] - 2023-01-26

### 改进

* 移除无人维护的语言文件
* 提升画廊详情页缩略图渲染效率，在多缩略图情况下有效改善卡顿
* 画廊详情页加载更多缩略图时从当前阅览的下一张开始

### Bug 修复

* 修正长方形头像的显示问题
* 修复偶尔有缩略图不加载的问题

## [1.7.28.4] - 2023-01-15

### 改进

* 支持置顶下载项目，搭配标题筛选可快速按系列整理下载内容
* 下载界面添加更多排序方式
* 下载界面添加“全部”下载标签
* 添加开始下载种子文件的提示
* 归档文件下载界面隐藏不可用的下载选项
* 支持在画廊详情界面长按收藏按钮编辑备注
* 从上至下阅读模式下双击不会再缩小到 0.5
* 下载时始终优先从缓存读取 GIF 动图，减少配额损耗

### Bug 修复

* 修复了几处奔溃
* 修复 Extended 模式下不显示收藏备注
* 修复某些情况下 GIF 播放速度异常
* 修复直接下载的图片文件扩展名错误

## [1.7.28.3] - 2023-01-09

### 改进

* 支持仅在下载时下载原图
* 支持显示和添加收藏备注

### Bug 修复

* 修复某些情况下进入下载页面闪退

## [1.7.28.2] - 2023-01-07

### 改进

* 为种子下载页面添加更多信息
* 支持不通过 H@H 下载压缩包
* 更改排行榜顺序，优先显示昨日排行

### Bug 修复

* 修复某些情况下主页无法加载
* 修复某些情况下对下载目录进行轮询阻塞 UI 的问题

## [1.7.28.1] - 2023-01-01

### 改进

* 下载页面添加标题筛选与排序功能
* 为 H@H 下载添加文件大小及下载资费显示

### Bug 修复

* 修复上一版本跳转到末页功能无效

## [1.7.28] - 2022-12-30

### 改进

* 压缩包支持按图片文件名顺序阅读 [Ehviewer-Overhauled/Ehviewer#427](https://github.com/Ehviewer-Overhauled/EhViewer/issues/427)
* 阅读界面拖动进度条实时跳转
* 优化从上至下阅读模式下的阅读进度显示，支持识别最后一页 [Ehviewer-Overhauled/Ehviewer#362](https://github.com/Ehviewer-Overhauled/EhViewer/issues/362)
* 从上至下阅读模式允许将图片缩小到 0.5
* 所有语言均支持标签建议，标签建议中完全匹配的标签优先显示
* 缩略图模式支持显示画廊标题
* 支持 GID 跳页与跳转到末页
* 快速搜索支持保存 GID 位置信息

### Bug 修复

* 修复部分情况下的闪退问题
* 修复本地收藏搜索
* 修复加载上一页后打开当前页画廊错误 [Ehviewer-Overhauled/Ehviewer#201](https://github.com/Ehviewer-Overhauled/EhViewer/issues/201)
* 重构 getPageData，修复页面加载时打开画廊再返回后卡住 [Ehviewer-Overhauled/Ehviewer#210](https://github.com/Ehviewer-Overhauled/EhViewer/issues/210)

## [1.7.28.0-b2] - 2022-12-11

### 改进

* 添加评论用户屏蔽和评论内容正则屏蔽功能
* 搜索历史长按直接删除，无需二次确认，与原版表现一致
* 使用 room paging 重构数据库和历史页面，历史记录现在不再有数量限制
* 将 跳过登录 重命名为 游客模式，防止被跳广告软件跳过登录
* 在画廊详情页删除下载时支持同时删除文件
* 适配 Android 13 的语言选择器

### Bug 修复

* 修复图片搜索选择图片后不显示预览的问题
* 修复无主画廊上传者显示，添加私密画廊分类

## [1.7.28.0-b1] - 2022-12-03

### 重大变更

* 从此版本开始，最低要求 Android 9
* 将归档组件从 p7zip 迁移到 libarchive 实现
    * 更多归档格式支持 (.gz .xz .tar .cbz .cbr)
    * 支持打开加密的压缩包 (7z 暂不支持 [Ehviewer-Overhauled/Ehviewer#114](https://github.com/Ehviewer-Overhauled/EhViewer/issues/114))
    * 流式读取 (会影响图片顺序 [Ehviewer-Overhauled/Ehviewer#427](https://github.com/Ehviewer-Overhauled/EhViewer/issues/427))
* 将图像解码组件更换为 ImageDecoder Java API 实现
    * 更优秀的性能

### 改进

* 在画廊详情页面添加返回按钮
* 扩大 缩略图模式下缩略图/详情页面预览图 大小调整范围

### Bug 修复

* 修复列表页面标签解析

## [1.7.27-final] - 2022-11-29

### 重大变更

* 从下一版本开始最低要求 Android 9

### 改进

* 修改深色模式下 detail button 颜色
* 最低支持到 Android 6

### Bug 修复

* 修复部分情况下的时区错乱

## [1.7.27.8] - 2022-11-24

### 改进

* 收藏页面添加全选功能，方便整理收藏夹
* 改善对安卓 10 以下系统的兼容性
* 添加 IP 被墙标记，暂时性改善表站直连

### Bug 修复

* 修复标签和上传者页面的跳页功能

## [1.7.27.7] - 2022-11-19

### 改进

* 支持备份在线收藏至本地
* 支持隐藏画廊详情页评论区
* 支持隐藏 HV 事件通知
* 支持设置列表模式下缩略图大小
* 支持设置画廊详情页预览图最大数量 (首先需要在网页设置中增加预览行数)，在低端设备上降低此值可缓解卡顿
* 限制日期选择器的选择范围
* 当预览只有一页时隐藏预览界面跳页按钮
* 移除“修正缩略图链接”
* 提升 targetSdkVersion 至 33

## [1.7.27.6] - 2022-11-16

### 重大变更

* 适配 E 站全新的搜索系统，请阅读 [更新原帖](https://forums.e-hentai.org/index.php?showtopic=261743) 了解详细信息

### 改进

* 移除了墨水屏模式
* 移除了统计相关代码
* 更改了包名和签名
